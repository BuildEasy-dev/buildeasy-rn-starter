# Feed & Photos åŠŸèƒ½å¤ç”¨ä»£ç åˆ†æ

## æ¦‚è¿°

å¯¹ `src/features/feed/` å’Œ `src/features/photos/` è¿›è¡Œäº†æ·±åº¦åˆ†æï¼Œè¯†åˆ«å‡ºå¤§é‡å¯å¤ç”¨çš„å…¬å…±ä»£ç æ¨¡å¼ã€‚

## å·²å®Œæˆ

- âœ… åˆ›å»º `src/utils/` é€šç”¨å·¥å…·ç›®å½•
- âœ… å®ç°æ—¶é—´å·¥å…·å‡½æ•° (`src/utils/time.ts`)

## å‘ç°çš„å¯å¤ç”¨æ¨¡å¼

### 1. ç”¨æˆ·ä¿¡æ¯æ¥å£ ğŸ”„

**å½“å‰çŠ¶æ€**: é‡å¤å®šä¹‰

- **Feed**: `author` å­—æ®µ - `{name, username, avatar?, verified?}`
- **Photos**: `user` å­—æ®µ - `{id, username, name, avatar?, verified?}`

**å»ºè®®**: åˆ›å»ºç»Ÿä¸€çš„ `User` æ¥å£

```typescript
interface User {
  id: string;
  username: string;
  name: string;
  avatar?: string;
  verified?: boolean;
}
```

### 2. ç»Ÿè®¡æ•°æ®æ¥å£ ğŸ”„

**å½“å‰çŠ¶æ€**: ç±»ä¼¼ä½†ä¸ä¸€è‡´

- **Feed**: `{likes, reposts, replies, views?}`
- **Photos**: `{likes, comments, shares?}`

**å»ºè®®**: åˆ›å»ºçµæ´»çš„ `PostStats` æ¥å£

```typescript
interface PostStats {
  likes: number;
  comments?: number;
  reposts?: number;
  replies?: number;
  shares?: number;
  views?: number;
}
```

### 3. FeedçŠ¶æ€ç®¡ç†Hook ğŸ”„

**å½“å‰çŠ¶æ€**: é«˜åº¦ç›¸ä¼¼çš„çŠ¶æ€ç®¡ç†é€»è¾‘

- ä¸¤ä¸ªhookséƒ½ç®¡ç†: `posts[], loading, error, refreshing, hasMore`
- ç›¸åŒçš„åˆ†é¡µåŠ è½½æ¨¡å¼
- ç›¸åŒçš„åˆ·æ–°é€»è¾‘

**å»ºè®®**: åˆ›å»ºé€šç”¨ `useFeedState<T>` Hook

### 4. ä¹è§‚æ›´æ–°æ¨¡å¼ ğŸ”„

**å½“å‰çŠ¶æ€**: å®Œå…¨ç›¸åŒçš„å®ç°æ¨¡å¼

- ç«‹å³æ›´æ–°UIçŠ¶æ€
- APIè°ƒç”¨å¤±è´¥æ—¶å›æ»š
- ç›¸åŒçš„é”™è¯¯å¤„ç†é€»è¾‘

**å»ºè®®**: æŠ½å– `optimisticUpdate()` å·¥å…·å‡½æ•°

### 5. APIæ¨¡æ‹Ÿé€»è¾‘ ğŸ”„

**å½“å‰çŠ¶æ€**: é‡å¤çš„å»¶è¿Ÿæ¨¡æ‹Ÿ

- `setTimeout(resolve, 1500)` - æ•°æ®åŠ è½½å»¶è¿Ÿ
- `setTimeout(resolve, 200)` - äº¤äº’æ“ä½œå»¶è¿Ÿ

**å»ºè®®**: åˆ›å»º `simulateApiCall()` å·¥å…·å‡½æ•°

### 6. æ—¶é—´æˆ³å¤„ç† âœ…

**çŠ¶æ€**: å·²å®Œæˆ

- åˆ›å»ºäº† `src/utils/time.ts` å·¥å…·å‡½æ•°
- åŒ…å«ç›¸å¯¹æ—¶é—´ã€æ—¥æœŸæ ¼å¼åŒ–ç­‰åŠŸèƒ½

## æ¨èçš„é‡æ„æ­¥éª¤

### Phase 1: æ ¸å¿ƒæ¥å£ç»Ÿä¸€

1. åˆ›å»º `src/types/common.ts` - é€šç”¨æ¥å£å®šä¹‰
2. å®šä¹‰ç»Ÿä¸€çš„ User, PostStats æ¥å£
3. æ›´æ–°ä¸¤ä¸ªåŠŸèƒ½ä½¿ç”¨æ–°æ¥å£

### Phase 2: çŠ¶æ€ç®¡ç†æŠ½è±¡

1. åˆ›å»º `src/hooks/use-feed-state.ts` - é€šç”¨FeedçŠ¶æ€ç®¡ç†
2. å®ç°æ³›å‹ `useFeedState<T>` Hook
3. é‡æ„ä¸¤ä¸ªåŠŸèƒ½ä½¿ç”¨é€šç”¨Hook

### Phase 3: APIå·¥å…·æŠ½è±¡

1. åˆ›å»º `src/utils/api.ts` - APIæ¨¡æ‹Ÿå·¥å…·
2. åˆ›å»º `src/utils/optimistic-updates.ts` - ä¹è§‚æ›´æ–°å·¥å…·
3. é‡æ„ç°æœ‰APIè°ƒç”¨ä½¿ç”¨æ–°å·¥å…·

### Phase 4: ç»„ä»¶å±‚é¢ä¼˜åŒ–

1. è¯†åˆ«å¯å¤ç”¨çš„UIç»„ä»¶æ¨¡å¼
2. æŠ½å–é€šç”¨äº¤äº’ç»„ä»¶
3. ç»Ÿä¸€æ ·å¼å’Œè¡Œä¸º

## é¢„æœŸæ”¶ç›Š

- **ä»£ç å‡å°‘**: é¢„è®¡å‡å°‘ 40-50% é‡å¤ä»£ç 
- **ä¸€è‡´æ€§**: ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒå’ŒAPIè¡Œä¸º
- **å¯ç»´æŠ¤æ€§**: ä¿®æ”¹ä¸€å¤„å³å¯å½±å“æ‰€æœ‰åŠŸèƒ½
- **å¯æ‰©å±•æ€§**: æ–°åŠŸèƒ½å¯å¿«é€Ÿå¤ç”¨ç°æœ‰æ¨¡å¼
- **ç±»å‹å®‰å…¨**: TypeScriptç±»å‹å¤ç”¨å‡å°‘é”™è¯¯

## é£é™©è¯„ä¼°

- **ä½é£é™©**: æ¥å£ç»Ÿä¸€å’Œå·¥å…·å‡½æ•°æŠ½å–
- **ä¸­é£é™©**: Hooké‡æ„éœ€è¦ä»”ç»†æµ‹è¯•çŠ¶æ€é€»è¾‘
- **å»ºè®®**: é€æ­¥é‡æ„ï¼Œæ¯é˜¶æ®µå……åˆ†æµ‹è¯•

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

å»ºè®®ä» Phase 1 å¼€å§‹ï¼Œé€æ­¥å®æ–½é‡æ„è®¡åˆ’ã€‚æ¯ä¸ªé˜¶æ®µå®Œæˆåè¿›è¡Œå……åˆ†æµ‹è¯•å†è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚
